#!/usr/bin/with-contenv bash

source /etc/wp/directories


#======================================================================================================================
# Clean directories
#======================================================================================================================

_echo "deleting contents of ${WWW} and ${WP}..."
rm -rf ${WWW}/* ${WP}/*
_done


#======================================================================================================================
# Download WordPress
#======================================================================================================================

cd /tmp

URL="https://${WORDPRESS_LOCALE}.wordpress.org/latest-${WORDPRESS_LOCALE}.zip"
_echo "downloading ${URL}..."
wget -O wp.zip ${URL}
unzip -q wp.zip
rm wp.zip

if [ -d ./wordpress ] ; then
    _done
else
    _error "error."
    exit 1
fi


#======================================================================================================================
# Move WordPress files to /www
#======================================================================================================================

_echo "moving WordPress files to ${WWW}..."
mv wordpress/* ${WWW}
rm -rf wordpress
_done
